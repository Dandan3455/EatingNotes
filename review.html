<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>å¾…å®¡æ ¸é£Ÿç‰©åˆ—è¡¨</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <h1>ğŸ“ å¾…å®¡æ ¸é£Ÿç‰©</h1>
  <p>è¯·å®¡æ ¸ç”¨æˆ·æäº¤çš„é£Ÿç‰©ï¼Œå°†å…¶åŠ å…¥ä¸»åº“æˆ–æ‹’ç»ã€‚</p>
  <ul id="pendingList"></ul>

  <script type="module">
  import { getPendingFoods, removePendingFood } from './pendingFoodService.js';
  import { addFood } from './foodLibraryService.js';

  const listEl = document.getElementById('pendingList');

  // æ¸²æŸ“å¾…å®¡æ ¸åˆ—è¡¨
  async function renderPending() {
    const items = await getPendingFoods();
    listEl.innerHTML = '';
    if (items.length === 0) {
      listEl.innerHTML = '<li>ç›®å‰æ²¡æœ‰å¾…å®¡æ ¸æ¡ç›®</li>';
      return;
    }
    items.forEach(item => {
      const li = document.createElement('li');
      li.textContent = `${item.name} â€” ${item.cal} cal `;
      // é€šè¿‡æŒ‰é’®
      const ok = document.createElement('button');
      ok.textContent = 'é€šè¿‡';
      ok.addEventListener('click', async () => {
        await addFood(item);
        await removePendingFood(item.name);
        renderPending();
        alert(`å·²å°† ${item.name} åŠ å…¥ä¸»é£Ÿç‰©åº“`);
      });
      // æ‹’ç»æŒ‰é’®
      const reject = document.createElement('button');
      reject.textContent = 'æ‹’ç»';
      reject.addEventListener('click', async () => {
        await removePendingFood(item.name);
        renderPending();
        alert(`å·²æ‹’ç» ${item.name}`);
      });
      li.appendChild(ok);
      li.appendChild(reject);
      listEl.appendChild(li);
    });
  }

  // é¡µé¢åŠ è½½æ—¶æ¸²æŸ“
  window.addEventListener('load', renderPending);
  </script>
</body>
</html>
